<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><link rel="icon" href="/sotoy/favicon.ico"/><title>Building a Robust Live Log Viewer with FastAPI and Server-Sent Events</title><meta name="robots" content="index,follow"/><meta name="googlebot" content="index,follow"/><meta name="description" content="Personal knowledge space about anything I learn. Notes, knowledge, and ideas from me."/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="zeihanaulia"/><meta name="twitter:creator" content="zeihanaulia"/><meta property="og:title" content="Building a Robust Live Log Viewer with FastAPI and Server-Sent Events"/><meta property="og:description" content="Personal knowledge space about anything I learn. Notes, knowledge, and ideas from me."/><meta property="og:url" content="https://zeihanaulia.github.io/sotoy/notes/gftz68j3eoioq2s8uhw43o1/"/><meta property="og:type" content="article"/><meta property="article:published_time" content="5/21/2025"/><meta property="article:modified_time" content="5/21/2025"/><meta property="og:image" content="https://pbs.twimg.com/profile_images/502375255256485888/1UYtt7PT_400x400.jpeg"/><meta property="og:image:alt" content="Software Engineer, "/><link rel="canonical" href="https://zeihanaulia.github.io/sotoy/notes/gftz68j3eoioq2s8uhw43o1/"/><meta name="next-head-count" content="19"/><link rel="preload" href="/sotoy/_next/static/css/41067a1ca86a1f32.css" as="style"/><link rel="stylesheet" href="/sotoy/_next/static/css/41067a1ca86a1f32.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/sotoy/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/sotoy/_next/static/chunks/webpack-3978769f38772f6c.js" defer=""></script><script src="/sotoy/_next/static/chunks/framework-28c999baf2863c3d.js" defer=""></script><script src="/sotoy/_next/static/chunks/main-5b62020850a4108f.js" defer=""></script><script src="/sotoy/_next/static/chunks/pages/_app-38d6e24c790d891f.js" defer=""></script><script src="/sotoy/_next/static/chunks/935-4dee79e80b8641c6.js" defer=""></script><script src="/sotoy/_next/static/chunks/6-50972def09142ee2.js" defer=""></script><script src="/sotoy/_next/static/chunks/pages/notes/%5Bid%5D-78d472fa3b924116.js" defer=""></script><script src="/sotoy/_next/static/l_PAyXQBStiOpWGlqI7Zj/_buildManifest.js" defer=""></script><script src="/sotoy/_next/static/l_PAyXQBStiOpWGlqI7Zj/_ssgManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><section class="ant-layout" style="width:100%;min-height:100%"><header class="ant-layout-header" style="position:fixed;isolation:isolate;z-index:1;width:100%;border-bottom:1px solid #d4dadf;height:64px;padding:0 24px 0 2px"><div class="ant-row ant-row-center" style="max-width:992px;justify-content:space-between;margin:0 auto"><div style="display:flex" class="ant-col ant-col-xs-20 ant-col-sm-4"></div><div class="ant-col gutter-row ant-col-xs-0 ant-col-sm-20 ant-col-md-20 ant-col-lg-19"><div class="ant-select ant-select-lg ant-select-auto-complete ant-select-single ant-select-allow-clear ant-select-show-search" style="width:100%"><div class="ant-select-selector"><span class="ant-select-selection-search"><input type="search" autoComplete="off" class="ant-select-selection-search-input" role="combobox" aria-haspopup="listbox" aria-owns="undefined_list" aria-autocomplete="list" aria-controls="undefined_list" aria-activedescendant="undefined_list_0" value=""/></span><span class="ant-select-selection-placeholder">For full text search please use the &#x27;?&#x27; prefix. e.g. ? Onboarding</span></div></div></div><div style="display:none;align-items:center;justify-content:center" class="ant-col ant-col-xs-4 ant-col-sm-4 ant-col-md-0 ant-col-lg-0"><span role="img" aria-label="menu" style="font-size:24px" tabindex="-1" class="anticon anticon-menu"><svg viewBox="64 64 896 896" focusable="false" data-icon="menu" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M904 160H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0 624H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0-312H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8z"></path></svg></span></div></div></header><section class="ant-layout" style="margin-top:64px;display:flex;flex-direction:row"><div class="site-layout-sidebar" style="flex:0 0 auto;width:calc(max((100% - 992px) / 2, 0px) + 200px);min-width:200px;padding-left:calc((100% - 992px) / 2)"><aside class="ant-layout-sider ant-layout-sider-dark" style="position:fixed;overflow:auto;height:calc(100vh - 64px);background-color:transparent;flex:0 0 200px;max-width:200px;min-width:200px;width:200px"><div class="ant-layout-sider-children"></div></aside></div><main class="ant-layout-content side-layout-main" style="max-width:1200px;min-width:0;display:block"><div style="padding:0 24px"><div class="main-content" role="main"><div class="ant-row"><div class="ant-col ant-col-24"><div class="ant-row" style="margin-left:-10px;margin-right:-10px"><div style="padding-left:10px;padding-right:10px" class="ant-col ant-col-xs-24 ant-col-md-18"><div><h1 id="building-a-robust-live-log-viewer-with-fastapi-and-server-sent-events">Building a Robust Live Log Viewer with FastAPI and Server-Sent Events<a aria-hidden="true" class="anchor-heading icon-link" href="#building-a-robust-live-log-viewer-with-fastapi-and-server-sent-events"></a></h1>
<p>Kadang lo bikin sistem yang kerjanya di balik layar. Kayak proses code generation yang lo trigger dari web, tapi di balik itu semua, ada proses AI yang jalan di background, parsing metadata, generate kode, dan simpen hasil. Masalahnya: user cuma liat loading spinner, padahal di balik layar lagi banyak hal seru—dan penting—yang terjadi.</p>
<p>Di sinilah lo pengen kasih visibility. Biar user bisa liat log secara real-time. Biar kalau mereka cabut dan balik lagi, masih bisa liat jejak prosesnya. Lo butuh log system yang ringan, bisa di-<em>stream</em>, dan bisa di-<em>persist</em>. Bukan cuma buat user experience, tapi juga buat debugging, QA, dan observabilitas internal tim dev.</p>
<p><img src="/sotoy/assets/til.python.building-sse/image.png" alt="alt text"></p>
<hr>
<h2 id="sistem-ini-dibangun-di-atas-tiga-pilar">Sistem Ini Dibangun di Atas Tiga Pilar<a aria-hidden="true" class="anchor-heading icon-link" href="#sistem-ini-dibangun-di-atas-tiga-pilar"></a></h2>
<p>FastAPI jadi tulang punggungnya. Server-Sent Events (SSE) yang ngirim log kayak radio satu arah. Dan Supabase jadi storage kalau semua udah kelar. Sisanya? Sedikit HTML dan JavaScript untuk prototipe awal.</p>
<p>Gue tau lo pengen cepat nyoba, jadi UI-nya nggak langsung React atau Refine. Nanti itu bisa nyusul. Sekarang yang penting jalan dulu.</p>
<pre class="language-sh"><code class="language-sh">+-----------+          SSE           +-----------------+
|           |  &#x3C;------------------  |                 |
|  FastAPI  | ------------------>   |   Frontend UI   |
| (Backend) |   Streaming Logs      | (HTML/JS/React) |
+-----------+                       +-----------------+
     |
     | Background Tasks
     |
     v
+------------------+
|  BufferedLogger  |
|  (In-Memory Log) |
+------------------+
     |
     | flush when done
     v
+------------------+
|    Supabase      |
| (Final Log Store)|
+------------------+

</code></pre>
<p>Gambaran besarnya:</p>
<ul>
<li>FastAPI jadi otaknya, ngatur semua routing dan trigger proses.</li>
<li>Frontend UI (HTML/JS awalnya, bisa evolve ke React) connect via SSE buat dapetin log real-time.</li>
<li>Sementara itu di dalam FastAPI, log dicatat dulu di BufferedLogger—disimpan sementara di memori.</li>
<li>Begitu prosesnya selesai, logger nge-flush log-nya ke Supabase buat diambil lagi nanti kalau user refresh atau datang belakangan.</li>
</ul>
<hr>
<h2 id="logger-komponen-paling-penting-yang-lo-gak-liat">Logger: Komponen Paling Penting yang Lo Gak Liat<a aria-hidden="true" class="anchor-heading icon-link" href="#logger-komponen-paling-penting-yang-lo-gak-liat"></a></h2>
<p>Di dalam FastAPI, kita bikin <code>BufferedLogger</code>. Ini semacam log manager lokal. Dia nyimpen log selama proses jalan, terus kasih akses ke client lewat <code>subscribe()</code> pake <code>asyncio.Queue</code>. Tiap log baru langsung dipush ke semua subscriber aktif. Dan kalau prosesnya udah selesai, dia <code>flush_to_supabase()</code> biar gak hilang.</p>
<p>Semua logger disimpan di satu peta global: <code>logger_map[(upload_id, service)]</code>. Jadi kapan pun, route mana pun, asal tau ID-nya, bisa ambil logger yang sama. Ini yang bikin komunikasi antara background task dan SSE handler jadi seamless.</p>
<pre class="language-python"><code class="language-python"><span class="token keyword">import</span> asyncio
<span class="token keyword">from</span> datetime <span class="token keyword">import</span> datetime
<span class="token keyword">from</span> typing <span class="token keyword">import</span> Literal


<span class="token keyword">class</span> <span class="token class-name">BufferedLogger</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>subscribers<span class="token punctuation">:</span> <span class="token builtin">list</span><span class="token punctuation">[</span>asyncio<span class="token punctuation">.</span>Queue<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        self<span class="token punctuation">.</span><span class="token builtin">buffer</span><span class="token punctuation">:</span> <span class="token builtin">list</span><span class="token punctuation">[</span><span class="token builtin">dict</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> 
        self<span class="token punctuation">.</span>done <span class="token operator">=</span> <span class="token boolean">False</span>
        self<span class="token punctuation">.</span>last_used <span class="token operator">=</span> datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>timestamp<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">subscribe</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> asyncio<span class="token punctuation">.</span>Queue<span class="token punctuation">:</span>
        queue <span class="token operator">=</span> asyncio<span class="token punctuation">.</span>Queue<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>subscribers<span class="token punctuation">.</span>append<span class="token punctuation">(</span>queue<span class="token punctuation">)</span>

        <span class="token comment"># Kirim log yang sudah ada ke subscriber baru</span>
        <span class="token keyword">for</span> entry <span class="token keyword">in</span> self<span class="token punctuation">.</span><span class="token builtin">buffer</span><span class="token punctuation">:</span>
            queue<span class="token punctuation">.</span>put_nowait<span class="token punctuation">(</span>entry<span class="token punctuation">)</span>

        <span class="token keyword">return</span> queue

    <span class="token keyword">def</span> <span class="token function">unsubscribe</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> queue<span class="token punctuation">:</span> asyncio<span class="token punctuation">.</span>Queue<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>subscribers<span class="token punctuation">.</span>remove<span class="token punctuation">(</span>queue<span class="token punctuation">)</span>
        <span class="token keyword">except</span> ValueError<span class="token punctuation">:</span>
            <span class="token keyword">pass</span>

    <span class="token keyword">def</span> <span class="token function">mark_done</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>done <span class="token operator">=</span> <span class="token boolean">True</span>

    <span class="token keyword">def</span> <span class="token function">log</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> message<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span> level<span class="token punctuation">:</span> Literal<span class="token punctuation">[</span><span class="token string">"info"</span><span class="token punctuation">,</span> <span class="token string">"error"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"info"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        entry <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token string">"timestamp"</span><span class="token punctuation">:</span> datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>isoformat<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token string">"log_level"</span><span class="token punctuation">:</span> level<span class="token punctuation">,</span>
            <span class="token string">"message"</span><span class="token punctuation">:</span> message
        <span class="token punctuation">}</span>

        <span class="token comment"># save buffer</span>
        self<span class="token punctuation">.</span><span class="token builtin">buffer</span><span class="token punctuation">.</span>append<span class="token punctuation">(</span>entry<span class="token punctuation">)</span>

        <span class="token comment"># Broadcast to all subscribers</span>
        <span class="token keyword">for</span> q <span class="token keyword">in</span> self<span class="token punctuation">.</span>subscribers<span class="token punctuation">:</span>
            q<span class="token punctuation">.</span>put_nowait<span class="token punctuation">(</span>entry<span class="token punctuation">)</span>

        self<span class="token punctuation">.</span>last_used <span class="token operator">=</span> datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>timestamp<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">flush_to_supabase</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> upload_id<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span> service<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span> supabase<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> entry <span class="token keyword">in</span> self<span class="token punctuation">.</span><span class="token builtin">buffer</span><span class="token punctuation">:</span>
            supabase<span class="token punctuation">.</span>table<span class="token punctuation">(</span><span class="token string">"runs_logs"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>insert<span class="token punctuation">(</span><span class="token punctuation">{</span>
                <span class="token string">"upload_id"</span><span class="token punctuation">:</span> upload_id<span class="token punctuation">,</span>
                <span class="token string">"service_name"</span><span class="token punctuation">:</span> service<span class="token punctuation">,</span>
                <span class="token string">"timestamp"</span><span class="token punctuation">:</span> entry<span class="token punctuation">[</span><span class="token string">"timestamp"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                <span class="token string">"log_level"</span><span class="token punctuation">:</span> entry<span class="token punctuation">[</span><span class="token string">"log_level"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                <span class="token string">"message"</span><span class="token punctuation">:</span> entry<span class="token punctuation">[</span><span class="token string">"message"</span><span class="token punctuation">]</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<hr>
<h2 id="jalankan-proses-stream-log-nya">Jalankan Proses, Stream Log-nya<a aria-hidden="true" class="anchor-heading icon-link" href="#jalankan-proses-stream-log-nya"></a></h2>
<p>Begitu user nge-trigger endpoint generate, lo bikin logger, simpan ke map, dan langsung jalanin background task. Tapi karena ini async, kita bungkus <code>background_task()</code> dalam lambda dan jalanin pake <code>asyncio.run()</code>. Di dalam situ, semua log dikirim via logger, dan pas udah selesai baru log-nya di-<em>flush</em> ke Supabase.</p>
<pre class="language-python"><code class="language-python"><span class="token keyword">from</span> fastapi <span class="token keyword">import</span> APIRouter<span class="token punctuation">,</span> BackgroundTasks<span class="token punctuation">,</span> Request
<span class="token keyword">from</span> starlette<span class="token punctuation">.</span>responses <span class="token keyword">import</span> StreamingResponse
<span class="token keyword">import</span> asyncio
<span class="token keyword">import</span> json

router <span class="token operator">=</span> APIRouter<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@router<span class="token punctuation">.</span>post</span><span class="token punctuation">(</span><span class="token string">"/{upload_id}/{service}/generate"</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">generate_code</span><span class="token punctuation">(</span>upload_id<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span> service<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span> background_tasks<span class="token punctuation">:</span> BackgroundTasks<span class="token punctuation">)</span><span class="token punctuation">:</span>
    logger <span class="token operator">=</span> BufferedLogger<span class="token punctuation">(</span><span class="token punctuation">)</span>
    logger_map<span class="token punctuation">[</span><span class="token punctuation">(</span>upload_id<span class="token punctuation">,</span> service<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> logger

    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">background_task</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            result <span class="token operator">=</span> <span class="token keyword">await</span> generate_and_save_code<span class="token punctuation">(</span>
                upload_id<span class="token operator">=</span>upload_id<span class="token punctuation">,</span>
                service<span class="token operator">=</span>service<span class="token punctuation">,</span>
                logger<span class="token operator">=</span>logger
            <span class="token punctuation">)</span>
        <span class="token keyword">finally</span><span class="token punctuation">:</span>
            logger<span class="token punctuation">.</span>done <span class="token operator">=</span> <span class="token boolean">True</span>
            <span class="token keyword">await</span> logger<span class="token punctuation">.</span>flush_to_supabase<span class="token punctuation">(</span>upload_id<span class="token punctuation">,</span> service<span class="token punctuation">)</span>
            logger_map<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token punctuation">(</span>upload_id<span class="token punctuation">,</span> service<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">)</span>

    <span class="token comment"># Bungkus coroutine ke dalam background thread</span>
    background_tasks<span class="token punctuation">.</span>add_task<span class="token punctuation">(</span><span class="token keyword">lambda</span><span class="token punctuation">:</span> asyncio<span class="token punctuation">.</span>run<span class="token punctuation">(</span>background_task<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token string">"status"</span><span class="token punctuation">:</span> <span class="token string">"Generation started"</span><span class="token punctuation">}</span>
</code></pre>
<p>Sementara itu, user bisa buka <code>/logs</code>, dan browser akan buka koneksi SSE. Tiap log masuk, langsung di-<em>yield</em> ke client. Kalau 30 detik gak ada apa-apa dan proses udah selesai, koneksi ditutup rapi, dan user dapet pesan terakhir: stream ended.</p>
<pre class="language-python"><code class="language-python"><span class="token decorator annotation punctuation">@router<span class="token punctuation">.</span>get</span><span class="token punctuation">(</span><span class="token string">"/{upload_id}/{service}/logs"</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">stream_logs</span><span class="token punctuation">(</span>upload_id<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span> service<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span> request<span class="token punctuation">:</span> Request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    logger <span class="token operator">=</span> logger_map<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">(</span>upload_id<span class="token punctuation">,</span> service<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token keyword">not</span> logger<span class="token punctuation">:</span>
        <span class="token keyword">return</span> StreamingResponse<span class="token punctuation">(</span>
            <span class="token builtin">iter</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"data: Log not available\n\n"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            media_type<span class="token operator">=</span><span class="token string">"text/event-stream"</span>
        <span class="token punctuation">)</span>

    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">event_stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        queue <span class="token operator">=</span> logger<span class="token punctuation">.</span>subscribe<span class="token punctuation">(</span><span class="token punctuation">)</span>
        idle_counter <span class="token operator">=</span> <span class="token number">0</span>

        <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> <span class="token keyword">await</span> request<span class="token punctuation">.</span>is_disconnected<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">break</span>
            <span class="token keyword">try</span><span class="token punctuation">:</span>
                log <span class="token operator">=</span> <span class="token keyword">await</span> asyncio<span class="token punctuation">.</span>wait_for<span class="token punctuation">(</span>queue<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span>
                idle_counter <span class="token operator">=</span> <span class="token number">0</span>
                <span class="token keyword">yield</span> <span class="token string-interpolation"><span class="token string">f"data: </span><span class="token interpolation"><span class="token punctuation">{</span>json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>log<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">\n\n"</span></span>
            <span class="token keyword">except</span> asyncio<span class="token punctuation">.</span>TimeoutError<span class="token punctuation">:</span>
                idle_counter <span class="token operator">+=</span> <span class="token number">1</span>
                <span class="token keyword">yield</span> <span class="token string">": keep-alive\n\n"</span>
                <span class="token keyword">if</span> idle_counter <span class="token operator">>=</span> <span class="token number">6</span> <span class="token keyword">and</span> logger<span class="token punctuation">.</span>done<span class="token punctuation">:</span>
                    <span class="token keyword">yield</span> <span class="token string-interpolation"><span class="token string">f"data: </span><span class="token interpolation"><span class="token punctuation">{</span>json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'message'</span><span class="token punctuation">:</span> <span class="token string">'Log stream ended.'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">\n\n"</span></span>
                    <span class="token keyword">break</span>

        logger<span class="token punctuation">.</span>unsubscribe<span class="token punctuation">(</span>queue<span class="token punctuation">)</span>

    <span class="token keyword">return</span> StreamingResponse<span class="token punctuation">(</span>event_stream<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> media_type<span class="token operator">=</span><span class="token string">"text/event-stream"</span><span class="token punctuation">)</span>
</code></pre>
<p>Nah, bagian ini yang bikin prosesnya kerasa live. Tiap kali logger .log(...), semua subscriber bakal dapet update, dan user bisa ngeliat langsung progres di layar. Dan karena pakai asyncio.Queue, gak akan blocking route lain—FastAPI tetep responsif.</p>
<p>Dengan kombinasi background_tasks, logger in-memory, dan SSE, proses panjang kayak code generation atau data processing jadi jauh lebih transparan buat user. Lo gak cuma bikin sistem jalan, tapi bikin user ngerti apa yang lagi dikerjain.</p>
<hr>
<h2 id="kalau-telat-gak-masalah-ada-final-log">Kalau Telat? Gak Masalah. Ada Final Log<a aria-hidden="true" class="anchor-heading icon-link" href="#kalau-telat-gak-masalah-ada-final-log"></a></h2>
<pre class="language-sh"><code class="language-sh">[ User buka UI ]
       |
       v
[ UI panggil /status ]
       |
       v
[ Logger aktif? ]
   |             \
  Ya              Tidak
   |                |
   v                v
[SSE connect]    [GET /logs/final]
   |                |
   v                v
[Streaming]     [Ambil log dari Supabase]
   |                |
   v                v
[Tutup saat done]  [Tampilkan log final]

</code></pre>
<p>Gak semua user nungguin. Kadang mereka cabut, terus balik 5 menit lagi. Makanya lo siapin endpoint <code>/logs/final</code> buat ambil semua log yang udah di-<em>persist</em> ke Supabase. Tinggal fetch dan render ulang. Sesimpel itu.</p>
<pre class="language-python"><code class="language-python"><span class="token decorator annotation punctuation">@router<span class="token punctuation">.</span>get</span><span class="token punctuation">(</span><span class="token string">"/{upload_id}/{service}/logs/final"</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">get_logs_final</span><span class="token punctuation">(</span>upload_id<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span> service<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    response <span class="token operator">=</span> supabase<span class="token punctuation">.</span>table<span class="token punctuation">(</span><span class="token string">"runs_logs"</span><span class="token punctuation">)</span>\
        <span class="token punctuation">.</span>select<span class="token punctuation">(</span><span class="token string">"*"</span><span class="token punctuation">)</span>\
        <span class="token punctuation">.</span>eq<span class="token punctuation">(</span><span class="token string">"upload_id"</span><span class="token punctuation">,</span> upload_id<span class="token punctuation">)</span>\
        <span class="token punctuation">.</span>eq<span class="token punctuation">(</span><span class="token string">"service"</span><span class="token punctuation">,</span> service<span class="token punctuation">)</span>\
        <span class="token punctuation">.</span>order<span class="token punctuation">(</span><span class="token string">"timestamp"</span><span class="token punctuation">,</span> desc<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>\
        <span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token string">"logs"</span><span class="token punctuation">:</span> response<span class="token punctuation">.</span>data <span class="token keyword">or</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
</code></pre>
<p>Endpoint <code>/status</code> juga lo kasih buat ngecek: logger masih aktif gak? Kalau iya, jalanin SSE. Kalau enggak, langsung fetch final logs.</p>
<hr>
<h2 id="ui-html-cepat-kecil-gak-ribet">UI HTML: Cepat, Kecil, Gak Ribet<a aria-hidden="true" class="anchor-heading icon-link" href="#ui-html-cepat-kecil-gak-ribet"></a></h2>
<p>Jujur aja, lo butuh UI cepat buat testing, dan gak pengen terlalu berat setup-nya. Jadi pakai HTML murni dulu. Satu halaman, satu fungsi <code>startStream()</code>, dan satu kotak <code>&#x3C;pre></code> buat nampilin log.</p>
<p>Begitu tombol “Start” diklik, JS-nya ngecek status logger. Kalau masih aktif, dia buka koneksi SSE dan nampilin setiap log yang masuk. Kalau enggak, dia fallback ke log final dan render dari hasil Supabase. Log box otomatis scroll ke bawah tiap log baru masuk.</p>
<pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>html</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>head</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>title</span><span class="token punctuation">></span></span>OSB Logs UI<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>title</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">
    <span class="token keyword">function</span> <span class="token function">startStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> uploadId <span class="token operator">=</span> <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">getElementById</span><span class="token punctuation">(</span><span class="token string">'uploadId'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">value</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> service <span class="token operator">=</span> <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">getElementById</span><span class="token punctuation">(</span><span class="token string">'service'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">value</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> logContainer <span class="token operator">=</span> <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">getElementById</span><span class="token punctuation">(</span><span class="token string">'logs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      logContainer<span class="token punctuation">.</span><span class="token property-access">innerHTML</span> <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>

      <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/runs/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>uploadId<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>service<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/status</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token arrow operator">=></span> res<span class="token punctuation">.</span><span class="token method function property-access">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token parameter">status</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
          <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>status<span class="token punctuation">.</span><span class="token property-access">active</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">const</span> eventSource <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">EventSource</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/runs/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>uploadId<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>service<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/logs</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            eventSource<span class="token punctuation">.</span><span class="token method-variable function-variable method function property-access">onmessage</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
              <span class="token keyword control-flow">try</span> <span class="token punctuation">{</span>
                <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token known-class-name class-name">JSON</span><span class="token punctuation">.</span><span class="token method function property-access">parse</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span><span class="token property-access">data</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                logContainer<span class="token punctuation">.</span><span class="token property-access">innerHTML</span> <span class="token operator">+=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token embedded-code html">[${data.timestamp}] ${data.log_level.toUpperCase()}: ${data.message}\n</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
                logContainer<span class="token punctuation">.</span><span class="token property-access">scrollTop</span> <span class="token operator">=</span> logContainer<span class="token punctuation">.</span><span class="token property-access">scrollHeight</span><span class="token punctuation">;</span>
              <span class="token punctuation">}</span> <span class="token keyword control-flow">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">warn</span><span class="token punctuation">(</span><span class="token string">"Malformed log:"</span><span class="token punctuation">,</span> event<span class="token punctuation">.</span><span class="token property-access">data</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">;</span>
            eventSource<span class="token punctuation">.</span><span class="token method-variable function-variable method function property-access">onerror</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
              <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">error</span><span class="token punctuation">(</span><span class="token string">"SSE connection error"</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
              eventSource<span class="token punctuation">.</span><span class="token method function property-access">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              logContainer<span class="token punctuation">.</span><span class="token property-access">innerHTML</span> <span class="token operator">+=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token embedded-code html">\nLog stream ended. Please refresh to view saved logs.\n</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span> <span class="token keyword control-flow">else</span> <span class="token punctuation">{</span>
            <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/runs/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>uploadId<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>service<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/logs/final</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
              <span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token arrow operator">=></span> res<span class="token punctuation">.</span><span class="token method function property-access">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
              <span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token parameter">data</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
                <span class="token punctuation">(</span>data<span class="token punctuation">.</span><span class="token property-access">logs</span> <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">forEach</span><span class="token punctuation">(</span><span class="token parameter">log</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
                  logContainer<span class="token punctuation">.</span><span class="token property-access">innerHTML</span> <span class="token operator">+=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token embedded-code html">[${log.timestamp}] ${log.log_level.toUpperCase()}: ${log.message}\n</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>script</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>head</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>body</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">font-family</span><span class="token punctuation">:</span> sans-serif<span class="token punctuation">;</span> <span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token unit">em</span><span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>h2</span><span class="token punctuation">></span></span>Live Log Viewer<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>h2</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>label</span><span class="token punctuation">></span></span>Upload ID: <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>input</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>uploadId<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>label</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>br</span><span class="token punctuation">/></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>label</span><span class="token punctuation">></span></span>Service: <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>input</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>service<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>label</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>br</span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>br</span><span class="token punctuation">/></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>button</span> <span class="token special-attr"><span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value javascript language-javascript"><span class="token function">startStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span>Start<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>button</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>pre</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>logs<span class="token punctuation">"</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">background</span><span class="token punctuation">:</span><span class="token hexcode color">#111</span><span class="token punctuation">;</span><span class="token property">color</span><span class="token punctuation">:</span><span class="token hexcode color">#0f0</span><span class="token punctuation">;</span><span class="token property">padding</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token unit">em</span><span class="token punctuation">;</span><span class="token property">height</span><span class="token punctuation">:</span><span class="token number">400</span><span class="token unit">px</span><span class="token punctuation">;</span><span class="token property">overflow</span><span class="token punctuation">:</span>auto<span class="token punctuation">;</span><span class="token property">white-space</span><span class="token punctuation">:</span> pre-wrap<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>pre</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>html</span><span class="token punctuation">></span></span>

</code></pre>
<p>Kelebihan pendekatan ini? Gak ada dependency frontend. Bisa langsung nyatu sama FastAPI. Dan gampang banget buat debugging.</p>
<hr>
<h2 id="sebelum-masuk-production-ada-pr">Sebelum Masuk Production, Ada PR<a aria-hidden="true" class="anchor-heading icon-link" href="#sebelum-masuk-production-ada-pr"></a></h2>
<p>Sistem ini oke buat development, tapi buat jalan di Vercel, Railway, atau VM internal, lo mesti perhatiin beberapa hal.</p>
<p>Pertama, keamanan. Lo belum ada auth. Upload ID dan service bisa dimainin. Jadi perlu validasi ID dan tambahin token atau session check. Akses SSE juga harus dibatasi ke user yang emang punya akses. Admin dan dev aja, misalnya.</p>
<p>Kedua, skalabilitas. Logger sekarang disimpan di RAM. Kalau banyak user atau task, ini gak akan cukup. Lo bisa pindah ke Redis PubSub, atau Kafka kalau lo butuh multiple consumer yang konsumsi log-nya secara paralel.</p>
<p>Ketiga, reliabilitas. Saat idle 30 detik, koneksi ditutup. Tapi kalau user gak sadar, mereka pikir server-nya hang. Lo harus edukasi user atau bikin fallback UX yang jelas. Dan pastikan SSE-nya bisa recover kalau disconnect.</p>
<hr>
<h2 id="yang-kita-pelajari-sepanjang-jalan">Yang Kita Pelajari Sepanjang Jalan<a aria-hidden="true" class="anchor-heading icon-link" href="#yang-kita-pelajari-sepanjang-jalan"></a></h2>
<p>Ada beberapa hal yang terbukti berhasil.</p>
<p>Mulai dari yang lo butuh dulu, itu kunci. Awalnya cuma pakai Streamlit, terus berevolusi ke FastAPI dan SSE. Logger-nya juga dipisah dari storage—kerja di RAM, baru simpen saat selesai. Ini ngurangin pressure ke Supabase.</p>
<p>Async-nya juga beneran non-blocking. Lo bisa jalanin banyak request FastAPI lain tanpa terganggu sama log stream. Ini penting buat scalability.</p>
<p>Tapi gak semua hal berjalan mulus.</p>
<p>Pernah logger nyangkut karena client SSE disconnect tapi gak unsubscribe. Akhirnya logger-nya stay di RAM terus. Kadang juga log gak dikirim kalau gak ada log baru, dan user bingung. Fallback ke final logs juga gak otomatis, harus manual cek status dulu.</p>
<hr>
<h2 id="next-step-lo-pasti-tau-sendiri-arahannya">Next Step? Lo Pasti Tau Sendiri Arahannya<a aria-hidden="true" class="anchor-heading icon-link" href="#next-step-lo-pasti-tau-sendiri-arahannya"></a></h2>
<p>Kalau lo mau lebih niat, UI-nya bisa pindah ke React, pake Refine.dev biar modular dan punya UX yang proper. Kalau SSE udah gak cukup, dan lo pengen user bisa submit perintah balik (misalnya kirim prompt ke LLM), berarti waktunya upgrade ke WebSocket.</p>
<p>Dan biar log-nya makin berguna, lo bisa tambahin timestamp relatif, filter severity (INFO, ERROR), atau export ke file langsung.</p>
<p>Tapi intinya, lo udah punya fondasi kuat: sistem log streaming yang bisa live, bisa nyimpen, dan bisa dibersihin otomatis.</p>
<p>Kapan mau dipake di proyek lo yang berikutnya?</p></div></div><div style="padding-left:10px;padding-right:10px" class="ant-col ant-col-xs-0 ant-col-md-6"><div><div class=""><div class="ant-anchor-wrapper dendron-toc" style="max-height:calc(100vh - 64px);z-index:1"><div class="ant-anchor"><div class="ant-anchor-ink"><span class="ant-anchor-ink-ball"></span></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#sistem-ini-dibangun-di-atas-tiga-pilar" title="Sistem Ini Dibangun di Atas Tiga Pilar">Sistem Ini Dibangun di Atas Tiga Pilar</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#logger-komponen-paling-penting-yang-lo-gak-liat" title="Logger: Komponen Paling Penting yang Lo Gak Liat">Logger: Komponen Paling Penting yang Lo Gak Liat</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#jalankan-proses-stream-log-nya" title="Jalankan Proses, Stream Log-nya">Jalankan Proses, Stream Log-nya</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#kalau-telat-gak-masalah-ada-final-log" title="Kalau Telat? Gak Masalah. Ada Final Log">Kalau Telat? Gak Masalah. Ada Final Log</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#ui-html-cepat-kecil-gak-ribet" title="UI HTML: Cepat, Kecil, Gak Ribet">UI HTML: Cepat, Kecil, Gak Ribet</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#sebelum-masuk-production-ada-pr" title="Sebelum Masuk Production, Ada PR">Sebelum Masuk Production, Ada PR</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#yang-kita-pelajari-sepanjang-jalan" title="Yang Kita Pelajari Sepanjang Jalan">Yang Kita Pelajari Sepanjang Jalan</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#next-step-lo-pasti-tau-sendiri-arahannya" title="Next Step? Lo Pasti Tau Sendiri Arahannya">Next Step? Lo Pasti Tau Sendiri Arahannya</a></div></div></div></div></div></div></div></div></div></div></div><div class="ant-divider ant-divider-horizontal" role="separator"></div><footer class="ant-layout-footer" style="padding:0 24px 24px"></footer></main></section></section></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"note":{"id":"gftz68j3eoioq2s8uhw43o1","title":"Building a Robust Live Log Viewer with FastAPI and Server-Sent Events","desc":"","updated":1747852587739,"created":1747851734739,"custom":{},"fname":"til.python.building-sse","type":"note","vault":{"fsPath":"vault"},"contentHash":"95ff4c9a279a79a53a8ae36b02efd234","links":[],"anchors":{"sistem-ini-dibangun-di-atas-tiga-pilar":{"type":"header","text":"Sistem Ini Dibangun di Atas Tiga Pilar","value":"sistem-ini-dibangun-di-atas-tiga-pilar","line":16,"column":0,"depth":2},"logger-komponen-paling-penting-yang-lo-gak-liat":{"type":"header","text":"Logger: Komponen Paling Penting yang Lo Gak Liat","value":"logger-komponen-paling-penting-yang-lo-gak-liat","line":54,"column":0,"depth":2},"jalankan-proses-stream-log-nya":{"type":"header","text":"Jalankan Proses, Stream Log-nya","value":"jalankan-proses-stream-log-nya","line":121,"column":0,"depth":2},"kalau-telat-gak-masalah-ada-final-log":{"type":"header","text":"Kalau Telat? Gak Masalah. Ada Final Log","value":"kalau-telat-gak-masalah-ada-final-log","line":196,"column":0,"depth":2},"ui-html-cepat-kecil-gak-ribet":{"type":"header","text":"UI HTML: Cepat, Kecil, Gak Ribet","value":"ui-html-cepat-kecil-gak-ribet","line":241,"column":0,"depth":2},"sebelum-masuk-production-ada-pr":{"type":"header","text":"Sebelum Masuk Production, Ada PR","value":"sebelum-masuk-production-ada-pr","line":305,"column":0,"depth":2},"yang-kita-pelajari-sepanjang-jalan":{"type":"header","text":"Yang Kita Pelajari Sepanjang Jalan","value":"yang-kita-pelajari-sepanjang-jalan","line":317,"column":0,"depth":2},"next-step-lo-pasti-tau-sendiri-arahannya":{"type":"header","text":"Next Step? Lo Pasti Tau Sendiri Arahannya","value":"next-step-lo-pasti-tau-sendiri-arahannya","line":331,"column":0,"depth":2}},"children":[],"parent":"jycttur7a8w3cl70w69vrc9","data":{}},"body":"\u003ch1 id=\"building-a-robust-live-log-viewer-with-fastapi-and-server-sent-events\"\u003eBuilding a Robust Live Log Viewer with FastAPI and Server-Sent Events\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#building-a-robust-live-log-viewer-with-fastapi-and-server-sent-events\"\u003e\u003c/a\u003e\u003c/h1\u003e\n\u003cp\u003eKadang lo bikin sistem yang kerjanya di balik layar. Kayak proses code generation yang lo trigger dari web, tapi di balik itu semua, ada proses AI yang jalan di background, parsing metadata, generate kode, dan simpen hasil. Masalahnya: user cuma liat loading spinner, padahal di balik layar lagi banyak hal seru—dan penting—yang terjadi.\u003c/p\u003e\n\u003cp\u003eDi sinilah lo pengen kasih visibility. Biar user bisa liat log secara real-time. Biar kalau mereka cabut dan balik lagi, masih bisa liat jejak prosesnya. Lo butuh log system yang ringan, bisa di-\u003cem\u003estream\u003c/em\u003e, dan bisa di-\u003cem\u003epersist\u003c/em\u003e. Bukan cuma buat user experience, tapi juga buat debugging, QA, dan observabilitas internal tim dev.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/sotoy/assets/til.python.building-sse/image.png\" alt=\"alt text\"\u003e\u003c/p\u003e\n\u003chr\u003e\n\u003ch2 id=\"sistem-ini-dibangun-di-atas-tiga-pilar\"\u003eSistem Ini Dibangun di Atas Tiga Pilar\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#sistem-ini-dibangun-di-atas-tiga-pilar\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eFastAPI jadi tulang punggungnya. Server-Sent Events (SSE) yang ngirim log kayak radio satu arah. Dan Supabase jadi storage kalau semua udah kelar. Sisanya? Sedikit HTML dan JavaScript untuk prototipe awal.\u003c/p\u003e\n\u003cp\u003eGue tau lo pengen cepat nyoba, jadi UI-nya nggak langsung React atau Refine. Nanti itu bisa nyusul. Sekarang yang penting jalan dulu.\u003c/p\u003e\n\u003cpre class=\"language-sh\"\u003e\u003ccode class=\"language-sh\"\u003e+-----------+          SSE           +-----------------+\n|           |  \u0026#x3C;------------------  |                 |\n|  FastAPI  | ------------------\u003e   |   Frontend UI   |\n| (Backend) |   Streaming Logs      | (HTML/JS/React) |\n+-----------+                       +-----------------+\n     |\n     | Background Tasks\n     |\n     v\n+------------------+\n|  BufferedLogger  |\n|  (In-Memory Log) |\n+------------------+\n     |\n     | flush when done\n     v\n+------------------+\n|    Supabase      |\n| (Final Log Store)|\n+------------------+\n\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eGambaran besarnya:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eFastAPI jadi otaknya, ngatur semua routing dan trigger proses.\u003c/li\u003e\n\u003cli\u003eFrontend UI (HTML/JS awalnya, bisa evolve ke React) connect via SSE buat dapetin log real-time.\u003c/li\u003e\n\u003cli\u003eSementara itu di dalam FastAPI, log dicatat dulu di BufferedLogger—disimpan sementara di memori.\u003c/li\u003e\n\u003cli\u003eBegitu prosesnya selesai, logger nge-flush log-nya ke Supabase buat diambil lagi nanti kalau user refresh atau datang belakangan.\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"logger-komponen-paling-penting-yang-lo-gak-liat\"\u003eLogger: Komponen Paling Penting yang Lo Gak Liat\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#logger-komponen-paling-penting-yang-lo-gak-liat\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eDi dalam FastAPI, kita bikin \u003ccode\u003eBufferedLogger\u003c/code\u003e. Ini semacam log manager lokal. Dia nyimpen log selama proses jalan, terus kasih akses ke client lewat \u003ccode\u003esubscribe()\u003c/code\u003e pake \u003ccode\u003easyncio.Queue\u003c/code\u003e. Tiap log baru langsung dipush ke semua subscriber aktif. Dan kalau prosesnya udah selesai, dia \u003ccode\u003eflush_to_supabase()\u003c/code\u003e biar gak hilang.\u003c/p\u003e\n\u003cp\u003eSemua logger disimpan di satu peta global: \u003ccode\u003elogger_map[(upload_id, service)]\u003c/code\u003e. Jadi kapan pun, route mana pun, asal tau ID-nya, bisa ambil logger yang sama. Ini yang bikin komunikasi antara background task dan SSE handler jadi seamless.\u003c/p\u003e\n\u003cpre class=\"language-python\"\u003e\u003ccode class=\"language-python\"\u003e\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e asyncio\n\u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e datetime \u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e datetime\n\u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e typing \u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e Literal\n\n\n\u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eBufferedLogger\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003edef\u003c/span\u003e \u003cspan class=\"token function\"\u003e__init__\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eself\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n        self\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003esubscribers\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003elist\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003easyncio\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eQueue\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\n        self\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token builtin\"\u003ebuffer\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003elist\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token builtin\"\u003edict\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \n        self\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003edone \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token boolean\"\u003eFalse\u003c/span\u003e\n        self\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003elast_used \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e datetime\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003enow\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003etimestamp\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n    \u003cspan class=\"token keyword\"\u003edef\u003c/span\u003e \u003cspan class=\"token function\"\u003esubscribe\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eself\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003e\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e asyncio\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eQueue\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n        queue \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e asyncio\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eQueue\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n        self\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003esubscribers\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eappend\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003equeue\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n        \u003cspan class=\"token comment\"\u003e# Kirim log yang sudah ada ke subscriber baru\u003c/span\u003e\n        \u003cspan class=\"token keyword\"\u003efor\u003c/span\u003e entry \u003cspan class=\"token keyword\"\u003ein\u003c/span\u003e self\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token builtin\"\u003ebuffer\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n            queue\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eput_nowait\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eentry\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n        \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e queue\n\n    \u003cspan class=\"token keyword\"\u003edef\u003c/span\u003e \u003cspan class=\"token function\"\u003eunsubscribe\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eself\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e queue\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e asyncio\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eQueue\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n        \u003cspan class=\"token keyword\"\u003etry\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n            self\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003esubscribers\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eremove\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003equeue\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"token keyword\"\u003eexcept\u003c/span\u003e ValueError\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n            \u003cspan class=\"token keyword\"\u003epass\u003c/span\u003e\n\n    \u003cspan class=\"token keyword\"\u003edef\u003c/span\u003e \u003cspan class=\"token function\"\u003emark_done\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eself\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n        self\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003edone \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token boolean\"\u003eTrue\u003c/span\u003e\n\n    \u003cspan class=\"token keyword\"\u003edef\u003c/span\u003e \u003cspan class=\"token function\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eself\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e message\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estr\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e level\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e Literal\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"info\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"error\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"info\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n        entry \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"token string\"\u003e\"timestamp\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e datetime\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003enow\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eisoformat\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n            \u003cspan class=\"token string\"\u003e\"log_level\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e level\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n            \u003cspan class=\"token string\"\u003e\"message\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e message\n        \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"token comment\"\u003e# save buffer\u003c/span\u003e\n        self\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token builtin\"\u003ebuffer\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eappend\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eentry\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n        \u003cspan class=\"token comment\"\u003e# Broadcast to all subscribers\u003c/span\u003e\n        \u003cspan class=\"token keyword\"\u003efor\u003c/span\u003e q \u003cspan class=\"token keyword\"\u003ein\u003c/span\u003e self\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003esubscribers\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n            q\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eput_nowait\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eentry\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n        self\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003elast_used \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e datetime\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003enow\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003etimestamp\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n    \u003cspan class=\"token keyword\"\u003easync\u003c/span\u003e \u003cspan class=\"token keyword\"\u003edef\u003c/span\u003e \u003cspan class=\"token function\"\u003eflush_to_supabase\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eself\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e upload_id\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estr\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e service\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estr\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e supabase\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n        \u003cspan class=\"token keyword\"\u003efor\u003c/span\u003e entry \u003cspan class=\"token keyword\"\u003ein\u003c/span\u003e self\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token builtin\"\u003ebuffer\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n            supabase\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003etable\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"runs_logs\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003einsert\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"token string\"\u003e\"upload_id\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e upload_id\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n                \u003cspan class=\"token string\"\u003e\"service_name\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e service\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n                \u003cspan class=\"token string\"\u003e\"timestamp\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e entry\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"timestamp\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n                \u003cspan class=\"token string\"\u003e\"log_level\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e entry\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"log_level\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n                \u003cspan class=\"token string\"\u003e\"message\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e entry\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"message\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\n            \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eexecute\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003chr\u003e\n\u003ch2 id=\"jalankan-proses-stream-log-nya\"\u003eJalankan Proses, Stream Log-nya\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#jalankan-proses-stream-log-nya\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eBegitu user nge-trigger endpoint generate, lo bikin logger, simpan ke map, dan langsung jalanin background task. Tapi karena ini async, kita bungkus \u003ccode\u003ebackground_task()\u003c/code\u003e dalam lambda dan jalanin pake \u003ccode\u003easyncio.run()\u003c/code\u003e. Di dalam situ, semua log dikirim via logger, dan pas udah selesai baru log-nya di-\u003cem\u003eflush\u003c/em\u003e ke Supabase.\u003c/p\u003e\n\u003cpre class=\"language-python\"\u003e\u003ccode class=\"language-python\"\u003e\u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e fastapi \u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e APIRouter\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e BackgroundTasks\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e Request\n\u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e starlette\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eresponses \u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e StreamingResponse\n\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e asyncio\n\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e json\n\nrouter \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e APIRouter\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"token decorator annotation punctuation\"\u003e@router\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003epost\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"/{upload_id}/{service}/generate\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003easync\u003c/span\u003e \u003cspan class=\"token keyword\"\u003edef\u003c/span\u003e \u003cspan class=\"token function\"\u003egenerate_code\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eupload_id\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estr\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e service\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estr\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e background_tasks\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e BackgroundTasks\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n    logger \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e BufferedLogger\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    logger_map\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eupload_id\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e service\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e logger\n\n    \u003cspan class=\"token keyword\"\u003easync\u003c/span\u003e \u003cspan class=\"token keyword\"\u003edef\u003c/span\u003e \u003cspan class=\"token function\"\u003ebackground_task\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n        \u003cspan class=\"token keyword\"\u003etry\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n            result \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eawait\u003c/span\u003e generate_and_save_code\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n                upload_id\u003cspan class=\"token operator\"\u003e=\u003c/span\u003eupload_id\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n                service\u003cspan class=\"token operator\"\u003e=\u003c/span\u003eservice\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n                logger\u003cspan class=\"token operator\"\u003e=\u003c/span\u003elogger\n            \u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"token keyword\"\u003efinally\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n            logger\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003edone \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token boolean\"\u003eTrue\u003c/span\u003e\n            \u003cspan class=\"token keyword\"\u003eawait\u003c/span\u003e logger\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eflush_to_supabase\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eupload_id\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e service\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n            logger_map\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003epop\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eupload_id\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e service\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token boolean\"\u003eNone\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n    \u003cspan class=\"token comment\"\u003e# Bungkus coroutine ke dalam background thread\u003c/span\u003e\n    background_tasks\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eadd_task\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003elambda\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e asyncio\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003erun\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ebackground_task\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"status\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"Generation started\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eSementara itu, user bisa buka \u003ccode\u003e/logs\u003c/code\u003e, dan browser akan buka koneksi SSE. Tiap log masuk, langsung di-\u003cem\u003eyield\u003c/em\u003e ke client. Kalau 30 detik gak ada apa-apa dan proses udah selesai, koneksi ditutup rapi, dan user dapet pesan terakhir: stream ended.\u003c/p\u003e\n\u003cpre class=\"language-python\"\u003e\u003ccode class=\"language-python\"\u003e\u003cspan class=\"token decorator annotation punctuation\"\u003e@router\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eget\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"/{upload_id}/{service}/logs\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003easync\u003c/span\u003e \u003cspan class=\"token keyword\"\u003edef\u003c/span\u003e \u003cspan class=\"token function\"\u003estream_logs\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eupload_id\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estr\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e service\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estr\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e request\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e Request\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n    logger \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e logger_map\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eget\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eupload_id\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e service\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e \u003cspan class=\"token keyword\"\u003enot\u003c/span\u003e logger\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n        \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e StreamingResponse\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n            \u003cspan class=\"token builtin\"\u003eiter\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"data: Log not available\\n\\n\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n            media_type\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"text/event-stream\"\u003c/span\u003e\n        \u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n    \u003cspan class=\"token keyword\"\u003easync\u003c/span\u003e \u003cspan class=\"token keyword\"\u003edef\u003c/span\u003e \u003cspan class=\"token function\"\u003eevent_stream\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n        queue \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e logger\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003esubscribe\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n        idle_counter \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e\n\n        \u003cspan class=\"token keyword\"\u003ewhile\u003c/span\u003e \u003cspan class=\"token boolean\"\u003eTrue\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n            \u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eawait\u003c/span\u003e request\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eis_disconnected\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n                \u003cspan class=\"token keyword\"\u003ebreak\u003c/span\u003e\n            \u003cspan class=\"token keyword\"\u003etry\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n                log \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eawait\u003c/span\u003e asyncio\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003ewait_for\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003equeue\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eget\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e timeout\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token number\"\u003e5\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n                idle_counter \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e\n                \u003cspan class=\"token keyword\"\u003eyield\u003c/span\u003e \u003cspan class=\"token string-interpolation\"\u003e\u003cspan class=\"token string\"\u003ef\"data: \u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003ejson\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003edumps\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003elog\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token string\"\u003e\\n\\n\"\u003c/span\u003e\u003c/span\u003e\n            \u003cspan class=\"token keyword\"\u003eexcept\u003c/span\u003e asyncio\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eTimeoutError\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n                idle_counter \u003cspan class=\"token operator\"\u003e+=\u003c/span\u003e \u003cspan class=\"token number\"\u003e1\u003c/span\u003e\n                \u003cspan class=\"token keyword\"\u003eyield\u003c/span\u003e \u003cspan class=\"token string\"\u003e\": keep-alive\\n\\n\"\u003c/span\u003e\n                \u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e idle_counter \u003cspan class=\"token operator\"\u003e\u003e=\u003c/span\u003e \u003cspan class=\"token number\"\u003e6\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eand\u003c/span\u003e logger\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003edone\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n                    \u003cspan class=\"token keyword\"\u003eyield\u003c/span\u003e \u003cspan class=\"token string-interpolation\"\u003e\u003cspan class=\"token string\"\u003ef\"data: \u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003ejson\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003edumps\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token string\"\u003e'message'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'Log stream ended.'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token string\"\u003e\\n\\n\"\u003c/span\u003e\u003c/span\u003e\n                    \u003cspan class=\"token keyword\"\u003ebreak\u003c/span\u003e\n\n        logger\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eunsubscribe\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003equeue\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n    \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e StreamingResponse\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eevent_stream\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e media_type\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"text/event-stream\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eNah, bagian ini yang bikin prosesnya kerasa live. Tiap kali logger .log(...), semua subscriber bakal dapet update, dan user bisa ngeliat langsung progres di layar. Dan karena pakai asyncio.Queue, gak akan blocking route lain—FastAPI tetep responsif.\u003c/p\u003e\n\u003cp\u003eDengan kombinasi background_tasks, logger in-memory, dan SSE, proses panjang kayak code generation atau data processing jadi jauh lebih transparan buat user. Lo gak cuma bikin sistem jalan, tapi bikin user ngerti apa yang lagi dikerjain.\u003c/p\u003e\n\u003chr\u003e\n\u003ch2 id=\"kalau-telat-gak-masalah-ada-final-log\"\u003eKalau Telat? Gak Masalah. Ada Final Log\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#kalau-telat-gak-masalah-ada-final-log\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cpre class=\"language-sh\"\u003e\u003ccode class=\"language-sh\"\u003e[ User buka UI ]\n       |\n       v\n[ UI panggil /status ]\n       |\n       v\n[ Logger aktif? ]\n   |             \\\n  Ya              Tidak\n   |                |\n   v                v\n[SSE connect]    [GET /logs/final]\n   |                |\n   v                v\n[Streaming]     [Ambil log dari Supabase]\n   |                |\n   v                v\n[Tutup saat done]  [Tampilkan log final]\n\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eGak semua user nungguin. Kadang mereka cabut, terus balik 5 menit lagi. Makanya lo siapin endpoint \u003ccode\u003e/logs/final\u003c/code\u003e buat ambil semua log yang udah di-\u003cem\u003epersist\u003c/em\u003e ke Supabase. Tinggal fetch dan render ulang. Sesimpel itu.\u003c/p\u003e\n\u003cpre class=\"language-python\"\u003e\u003ccode class=\"language-python\"\u003e\u003cspan class=\"token decorator annotation punctuation\"\u003e@router\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eget\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"/{upload_id}/{service}/logs/final\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003easync\u003c/span\u003e \u003cspan class=\"token keyword\"\u003edef\u003c/span\u003e \u003cspan class=\"token function\"\u003eget_logs_final\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eupload_id\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estr\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e service\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estr\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n    response \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e supabase\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003etable\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"runs_logs\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\\\n        \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eselect\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"*\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\\\n        \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eeq\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"upload_id\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e upload_id\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\\\n        \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eeq\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"service\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e service\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\\\n        \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eorder\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"timestamp\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e desc\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token boolean\"\u003eFalse\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\\\n        \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eexecute\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n    \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"logs\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e response\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003edata \u003cspan class=\"token keyword\"\u003eor\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eEndpoint \u003ccode\u003e/status\u003c/code\u003e juga lo kasih buat ngecek: logger masih aktif gak? Kalau iya, jalanin SSE. Kalau enggak, langsung fetch final logs.\u003c/p\u003e\n\u003chr\u003e\n\u003ch2 id=\"ui-html-cepat-kecil-gak-ribet\"\u003eUI HTML: Cepat, Kecil, Gak Ribet\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#ui-html-cepat-kecil-gak-ribet\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eJujur aja, lo butuh UI cepat buat testing, dan gak pengen terlalu berat setup-nya. Jadi pakai HTML murni dulu. Satu halaman, satu fungsi \u003ccode\u003estartStream()\u003c/code\u003e, dan satu kotak \u003ccode\u003e\u0026#x3C;pre\u003e\u003c/code\u003e buat nampilin log.\u003c/p\u003e\n\u003cp\u003eBegitu tombol “Start” diklik, JS-nya ngecek status logger. Kalau masih aktif, dia buka koneksi SSE dan nampilin setiap log yang masuk. Kalau enggak, dia fallback ke log final dan render dari hasil Supabase. Log box otomatis scroll ke bawah tiap log baru masuk.\u003c/p\u003e\n\u003cpre class=\"language-html\"\u003e\u003ccode class=\"language-html\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003ehtml\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003ehead\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n  \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003etitle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003eOSB Logs UI\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003etitle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n  \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003escript\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token script\"\u003e\u003cspan class=\"token language-javascript\"\u003e\n    \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003estartStream\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e uploadId \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token dom variable\"\u003edocument\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003egetElementById\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'uploadId'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003evalue\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n      \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e service \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token dom variable\"\u003edocument\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003egetElementById\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'service'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003evalue\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n      \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e logContainer \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token dom variable\"\u003edocument\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003egetElementById\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'logs'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n      logContainer\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003einnerHTML\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e''\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n      \u003cspan class=\"token function\"\u003efetch\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token template-string\"\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003cspan class=\"token string\"\u003e/runs/\u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e${\u003c/span\u003euploadId\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token string\"\u003e/\u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e${\u003c/span\u003eservice\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token string\"\u003e/status\u003c/span\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003ethen\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eres\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e res\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003ejson\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003ethen\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003estatus\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n          \u003cspan class=\"token keyword control-flow\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003estatus\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003eactive\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e eventSource \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eEventSource\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token template-string\"\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003cspan class=\"token string\"\u003e/runs/\u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e${\u003c/span\u003euploadId\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token string\"\u003e/\u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e${\u003c/span\u003eservice\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token string\"\u003e/logs\u003c/span\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n            eventSource\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method-variable function-variable method function property-access\"\u003eonmessage\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eevent\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n              \u003cspan class=\"token keyword control-flow\"\u003etry\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e data \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token known-class-name class-name\"\u003eJSON\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eparse\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eevent\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edata\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n                logContainer\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003einnerHTML\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+=\u003c/span\u003e \u003cspan class=\"token template-string\"\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003cspan class=\"token embedded-code html\"\u003e[${data.timestamp}] ${data.log_level.toUpperCase()}: ${data.message}\\n\u003c/span\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n                logContainer\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003escrollTop\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e logContainer\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003escrollHeight\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n              \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003ecatch\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ee\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003ewarn\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"Malformed log:\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e event\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edata\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n              \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n            \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n            eventSource\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method-variable function-variable method function property-access\"\u003eonerror\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eerr\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n              \u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eerror\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"SSE connection error\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e err\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n              eventSource\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eclose\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n              logContainer\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003einnerHTML\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+=\u003c/span\u003e \u003cspan class=\"token template-string\"\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003cspan class=\"token embedded-code html\"\u003e\\nLog stream ended. Please refresh to view saved logs.\\n\u003c/span\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n          \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003eelse\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"token function\"\u003efetch\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token template-string\"\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003cspan class=\"token string\"\u003e/runs/\u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e${\u003c/span\u003euploadId\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token string\"\u003e/\u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e${\u003c/span\u003eservice\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token string\"\u003e/logs/final\u003c/span\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n              \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003ethen\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eres\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e res\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003ejson\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n              \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003ethen\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003edata\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003edata\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003elogs\u003c/span\u003e \u003cspan class=\"token operator\"\u003e||\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eforEach\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003elog\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n                  logContainer\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003einnerHTML\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+=\u003c/span\u003e \u003cspan class=\"token template-string\"\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003cspan class=\"token embedded-code html\"\u003e[${log.timestamp}] ${log.log_level.toUpperCase()}: ${log.message}\\n\u003c/span\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n              \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n          \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003escript\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003ehead\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003ebody\u003c/span\u003e \u003cspan class=\"token special-attr\"\u003e\u003cspan class=\"token attr-name\"\u003estyle\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003cspan class=\"token value css language-css\"\u003e\u003cspan class=\"token property\"\u003efont-family\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e sans-serif\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token property\"\u003epadding\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token unit\"\u003eem\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n  \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003eh2\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003eLive Log Viewer\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003eh2\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n  \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003elabel\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003eUpload ID: \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003einput\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003eid\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003euploadId\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003etype\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003etext\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e/\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003elabel\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003ebr\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e/\u003e\u003c/span\u003e\u003c/span\u003e\n  \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003elabel\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003eService: \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003einput\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003eid\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003eservice\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003etype\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003etext\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e/\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003elabel\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003ebr\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e/\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003ebr\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e/\u003e\u003c/span\u003e\u003c/span\u003e\n  \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003ebutton\u003c/span\u003e \u003cspan class=\"token special-attr\"\u003e\u003cspan class=\"token attr-name\"\u003eonclick\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003cspan class=\"token value javascript language-javascript\"\u003e\u003cspan class=\"token function\"\u003estartStream\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003eStart\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003ebutton\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n  \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003epre\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003eid\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003elogs\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token special-attr\"\u003e\u003cspan class=\"token attr-name\"\u003estyle\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003cspan class=\"token value css language-css\"\u003e\u003cspan class=\"token property\"\u003ebackground\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\u003cspan class=\"token hexcode color\"\u003e#111\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\u003cspan class=\"token property\"\u003ecolor\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\u003cspan class=\"token hexcode color\"\u003e#0f0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\u003cspan class=\"token property\"\u003epadding\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token unit\"\u003eem\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\u003cspan class=\"token property\"\u003eheight\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\u003cspan class=\"token number\"\u003e400\u003c/span\u003e\u003cspan class=\"token unit\"\u003epx\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\u003cspan class=\"token property\"\u003eoverflow\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003eauto\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\u003cspan class=\"token property\"\u003ewhite-space\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e pre-wrap\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003epre\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003ebody\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003ehtml\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eKelebihan pendekatan ini? Gak ada dependency frontend. Bisa langsung nyatu sama FastAPI. Dan gampang banget buat debugging.\u003c/p\u003e\n\u003chr\u003e\n\u003ch2 id=\"sebelum-masuk-production-ada-pr\"\u003eSebelum Masuk Production, Ada PR\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#sebelum-masuk-production-ada-pr\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eSistem ini oke buat development, tapi buat jalan di Vercel, Railway, atau VM internal, lo mesti perhatiin beberapa hal.\u003c/p\u003e\n\u003cp\u003ePertama, keamanan. Lo belum ada auth. Upload ID dan service bisa dimainin. Jadi perlu validasi ID dan tambahin token atau session check. Akses SSE juga harus dibatasi ke user yang emang punya akses. Admin dan dev aja, misalnya.\u003c/p\u003e\n\u003cp\u003eKedua, skalabilitas. Logger sekarang disimpan di RAM. Kalau banyak user atau task, ini gak akan cukup. Lo bisa pindah ke Redis PubSub, atau Kafka kalau lo butuh multiple consumer yang konsumsi log-nya secara paralel.\u003c/p\u003e\n\u003cp\u003eKetiga, reliabilitas. Saat idle 30 detik, koneksi ditutup. Tapi kalau user gak sadar, mereka pikir server-nya hang. Lo harus edukasi user atau bikin fallback UX yang jelas. Dan pastikan SSE-nya bisa recover kalau disconnect.\u003c/p\u003e\n\u003chr\u003e\n\u003ch2 id=\"yang-kita-pelajari-sepanjang-jalan\"\u003eYang Kita Pelajari Sepanjang Jalan\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#yang-kita-pelajari-sepanjang-jalan\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eAda beberapa hal yang terbukti berhasil.\u003c/p\u003e\n\u003cp\u003eMulai dari yang lo butuh dulu, itu kunci. Awalnya cuma pakai Streamlit, terus berevolusi ke FastAPI dan SSE. Logger-nya juga dipisah dari storage—kerja di RAM, baru simpen saat selesai. Ini ngurangin pressure ke Supabase.\u003c/p\u003e\n\u003cp\u003eAsync-nya juga beneran non-blocking. Lo bisa jalanin banyak request FastAPI lain tanpa terganggu sama log stream. Ini penting buat scalability.\u003c/p\u003e\n\u003cp\u003eTapi gak semua hal berjalan mulus.\u003c/p\u003e\n\u003cp\u003ePernah logger nyangkut karena client SSE disconnect tapi gak unsubscribe. Akhirnya logger-nya stay di RAM terus. Kadang juga log gak dikirim kalau gak ada log baru, dan user bingung. Fallback ke final logs juga gak otomatis, harus manual cek status dulu.\u003c/p\u003e\n\u003chr\u003e\n\u003ch2 id=\"next-step-lo-pasti-tau-sendiri-arahannya\"\u003eNext Step? Lo Pasti Tau Sendiri Arahannya\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#next-step-lo-pasti-tau-sendiri-arahannya\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eKalau lo mau lebih niat, UI-nya bisa pindah ke React, pake Refine.dev biar modular dan punya UX yang proper. Kalau SSE udah gak cukup, dan lo pengen user bisa submit perintah balik (misalnya kirim prompt ke LLM), berarti waktunya upgrade ke WebSocket.\u003c/p\u003e\n\u003cp\u003eDan biar log-nya makin berguna, lo bisa tambahin timestamp relatif, filter severity (INFO, ERROR), atau export ke file langsung.\u003c/p\u003e\n\u003cp\u003eTapi intinya, lo udah punya fondasi kuat: sistem log streaming yang bisa live, bisa nyimpen, dan bisa dibersihin otomatis.\u003c/p\u003e\n\u003cp\u003eKapan mau dipake di proyek lo yang berikutnya?\u003c/p\u003e","noteIndex":{"id":"oqxmejlafk9x8rj9t5hya5z","title":"Hello and Welcome! 👋","desc":"","updated":1742030256619,"created":1646842475821,"custom":{"nav_order":0,"permalink":"/"},"fname":"root","type":"note","vault":{"fsPath":"vault"},"contentHash":"f7db9d96297496e598d70248ef16b81f","links":[],"anchors":{"find-more":{"type":"header","text":"Find More","value":"find-more","line":20,"column":0,"depth":2}},"children":["spfwom01chbihki1twghclf","bsv930j2j6qlih60c7eu7wh","ohf85tu5nw2b8ewx6cetsmp","u3lhhpriar8wgcjw8svapha","tvdcga33h6hi7fxd9cwqd66"],"parent":null,"data":{},"body":"\nWelcome to the homepage! I use Dendron to store and organize notes, ideas, and experiments I’m working on. Here are the main sections you’ll find on this site:\n\n1. **Learning Notes** — Practical notes on programming, recent technologies, and productivity tips.\n2. **Personal Projects** — Summaries of projects, experiments, and outcomes I’m working on or have completed.\n3. **Writings \u0026 Opinions** — Casual articles and reflections about technology, daily life, and other interesting topics.\n\nI’m constantly experimenting and learning. I hope the content here helps you as a reference, a starting point for discussion, or just light reading.\n\n\u003e Why Dendron?\n\u003e\nDendron helps keep notes organized. Its \"seed\" and \"vault\" concepts make it easy to structure content and find what you need.\n\n## Find More\n\nIf you want to learn more or connect, check these links:\n\n- [Homepage (Dendron)](https://zeihanaulia.github.io/sotoy/)\n- [My GitHub](https://github.com/zeihanaulia)\n- [My Twitter / X](https://x.com/zeihanaulia)\n\nThanks for stopping by. If you have feedback or want to chat, feel free to reach out.\n"},"collectionChildren":null,"customHeadContent":null,"config":{"version":5,"dev":{"enablePreviewV2":true},"commands":{"lookup":{"note":{"selectionMode":"extract","confirmVaultOnCreate":true,"vaultSelectionModeOnCreate":"smart","leaveTrace":false,"bubbleUpCreateNew":true,"fuzzThreshold":0.2}},"randomNote":{},"insertNoteLink":{"aliasMode":"none","enableMultiSelect":false},"insertNoteIndex":{"enableMarker":false},"copyNoteLink":{"aliasMode":"title"},"templateHierarchy":"template"},"workspace":{"dendronVersion":"0.83.0","vaults":[{"fsPath":"vault"}],"journal":{"dailyDomain":"daily","name":"journal","dateFormat":"y.MM.dd","addBehavior":"childOfDomain"},"scratch":{"name":"scratch","dateFormat":"y.MM.dd.HHmmss","addBehavior":"asOwnDomain"},"task":{"name":"","dateFormat":"","addBehavior":"childOfCurrent","statusSymbols":{"":" ","wip":"w","done":"x","assigned":"a","moved":"m","blocked":"b","delegated":"l","dropped":"d","pending":"y"},"prioritySymbols":{"H":"high","M":"medium","L":"low"},"todoIntegration":false,"createTaskSelectionType":"selection2link","taskCompleteStatus":["done","x"]},"graph":{"zoomSpeed":1,"createStub":false},"enableAutoCreateOnDefinition":false,"enableXVaultWikiLink":false,"enableRemoteVaultInit":true,"enableUserTags":true,"enableHashTags":true,"workspaceVaultSyncMode":"noCommit","enableAutoFoldFrontmatter":false,"enableEditorDecorations":true,"maxPreviewsCached":10,"maxNoteLength":204800,"seeds":{"dendron.templates":{}},"enableFullHierarchyNoteTitle":false},"preview":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enableFrontmatterTags":true,"enableHashesForFMTags":false,"enablePrettyRefs":true,"enableKatex":true,"automaticallyShowPreview":false},"publishing":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enablePrettyRefs":true,"enableKatex":true,"copyAssets":true,"siteHierarchies":["root"],"writeStubs":true,"siteRootDir":"docs","seo":{"title":"Sotoy","description":"Personal knowledge space about anything I learn. Notes, knowledge, and ideas from me.","author":"Zeihan Aulia","twitter":"zeihanaulia","image":{"url":"https://pbs.twimg.com/profile_images/502375255256485888/1UYtt7PT_400x400.jpeg","alt":"Software Engineer, "}},"github":{"enableEditLink":true,"editLinkText":"Edit this page on GitHub","editBranch":"main","editViewMode":"tree"},"enableSiteLastModified":true,"enableFrontmatterTags":true,"enableHashesForFMTags":false,"enableRandomlyColoredTags":true,"enableTaskNotes":true,"enablePrettyLinks":true,"searchMode":"lookup","assetsPrefix":"/sotoy","siteUrl":"https://zeihanaulia.github.io","duplicateNoteBehavior":{"action":"useVault","payload":["vault-private","vault","dendron.templates"]},"siteFaviconPath":"favicon.ico","siteIndex":"root"}}},"__N_SSG":true},"page":"/notes/[id]","query":{"id":"gftz68j3eoioq2s8uhw43o1"},"buildId":"l_PAyXQBStiOpWGlqI7Zj","assetPrefix":"/sotoy","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>